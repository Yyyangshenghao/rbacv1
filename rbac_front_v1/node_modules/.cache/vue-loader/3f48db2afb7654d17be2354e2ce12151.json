{"remainingRequest":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\src\\views\\recognition\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\src\\views\\recognition\\index.vue","mtime":1705038915656},{"path":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1705038908307},{"path":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\babel-loader\\lib\\index.js","mtime":1705038907812},{"path":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1705038908307},{"path":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\vue-loader\\lib\\index.js","mtime":1705038915248}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGVtcGxveWVlSWQ6IHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd1c2VySWQnKSwNCiAgICAgIGJhc2U2NEltYWdlOiAiIiwNCiAgICAgIHNlbGVjdGVkRmlsZTogbnVsbCwNCiAgICB9DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5zZXR1cENhbWVyYSgpOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgYXN5bmMgc2V0dXBDYW1lcmEoKSB7DQogICAgICB0cnkgew0KICAgICAgICBjb25zdCBzdHJlYW0gPSBhd2FpdCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7IHZpZGVvOiB0cnVlIH0pOw0KICAgICAgICB0aGlzLiRyZWZzLnZpZGVvLnNyY09iamVjdCA9IHN0cmVhbTsNCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFjY2Vzc2luZyB0aGUgY2FtZXJhOicsIGVycm9yKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGNhcHR1cmVJbWFnZSgpIHsNCiAgICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuJHJlZnMuY2FudmFzOw0KICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgY29udGV4dC5kcmF3SW1hZ2UodGhpcy4kcmVmcy52aWRlbywgMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsNCiAgICAgIGxldCBiYXNlNjQgPSBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKTsNCiAgICAgIHRoaXMudXBsb2FkSW1hZ2UoYmFzZTY0KTsNCiAgICB9LA0KICAgIGFzeW5jIHVwbG9hZEltYWdlKGJhc2U2NCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgYmFzZTY0RGF0YSA9IGJhc2U2NC5yZXBsYWNlKC9eZGF0YTppbWFnZVwvW2Etel0rO2Jhc2U2NCwvLCAnJyk7DQogICAgICAgIGxldCBwYXlsb2FkID0gew0KICAgICAgICAgIGJhc2U2NEltYWdlOiBiYXNlNjREYXRhLA0KICAgICAgICAgIGVtcGxveWVlSWQ6IHRoaXMuZW1wbG95ZWVJZA0KICAgICAgICB9Ow0KICAgICAgICBhd2FpdCB0aGlzLiRodHRwLnBvc3QoJy9mYWNlL3VwbG9hZCcsIHBheWxvYWQpOw0KICAgICAgICBjb25zb2xlLmxvZygnSW1hZ2UgdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5Jyk7DQogICAgICAgIGNvbnNvbGUubG9nKHBheWxvYWQpOw0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBsb2FkaW5nIHRoZSBpbWFnZTonLCBlcnJvcik7DQogICAgICB9DQogICAgfSwNCiAgICBvbkZpbGVTZWxlY3RlZChldmVudCkgew0KICAgICAgdGhpcy5zZWxlY3RlZEZpbGUgPSBldmVudC50YXJnZXQuZmlsZXNbMF07DQogICAgfSwNCiAgICB1cGxvYWRGaWxlKCkgew0KICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsNCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIHRoaXMuc2VsZWN0ZWRGaWxlKTsNCg0KICAgICAgYXhpb3MucG9zdCgnL2ZhY2UvdXBsb2FkRmlsZScsIGZvcm1EYXRhLCB7DQogICAgICAgIGhlYWRlcnM6IHsNCiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGEnDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZpbGUgdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5Jyk7DQogICAgICAgICAgfSkNCiAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBsb2FkaW5nIHRoZSBmaWxlOicsIGVycm9yKTsNCiAgICAgICAgICB9KTsNCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAWA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/recognition","sourcesContent":["<template>\r\n  <div>\r\n    <video ref=\"video\" width=\"640\" height=\"480\" autoplay></video>\r\n    <button @click=\"captureImage\">拍照并上传</button>\r\n    <input type=\"file\" @change=\"onFileSelected\">\r\n    <button @click=\"uploadFile\">上传图片</button>\r\n    <canvas ref=\"canvas\" width=\"640\" height=\"480\" style=\"display: none;\"></canvas>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      employeeId: window.sessionStorage.getItem('userId'),\r\n      base64Image: \"\",\r\n      selectedFile: null,\r\n    }\r\n  },\r\n  mounted() {\r\n    this.setupCamera();\r\n  },\r\n  methods: {\r\n    async setupCamera() {\r\n      try {\r\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true });\r\n        this.$refs.video.srcObject = stream;\r\n      } catch (error) {\r\n        console.error('Error accessing the camera:', error);\r\n      }\r\n    },\r\n    captureImage() {\r\n      const canvas = this.$refs.canvas;\r\n      const context = canvas.getContext('2d');\r\n      context.drawImage(this.$refs.video, 0, 0, canvas.width, canvas.height);\r\n      let base64 = canvas.toDataURL('image/png');\r\n      this.uploadImage(base64);\r\n    },\r\n    async uploadImage(base64) {\r\n      try {\r\n        const base64Data = base64.replace(/^data:image\\/[a-z]+;base64,/, '');\r\n        let payload = {\r\n          base64Image: base64Data,\r\n          employeeId: this.employeeId\r\n        };\r\n        await this.$http.post('/face/upload', payload);\r\n        console.log('Image uploaded successfully');\r\n        console.log(payload);\r\n      } catch (error) {\r\n        console.error('Error uploading the image:', error);\r\n      }\r\n    },\r\n    onFileSelected(event) {\r\n      this.selectedFile = event.target.files[0];\r\n    },\r\n    uploadFile() {\r\n      const formData = new FormData();\r\n      formData.append('file', this.selectedFile);\r\n\r\n      axios.post('/face/uploadFile', formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data'\r\n        }\r\n      })\r\n          .then(response => {\r\n            console.log('File uploaded successfully');\r\n          })\r\n          .catch(error => {\r\n            console.error('Error uploading the file:', error);\r\n          });\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}]}