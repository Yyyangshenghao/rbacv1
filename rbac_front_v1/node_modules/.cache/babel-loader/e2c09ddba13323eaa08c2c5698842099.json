{"remainingRequest":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\babel-loader\\lib\\index.js!E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\src\\views\\recognition\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\src\\views\\recognition\\index.vue","mtime":1705038915656},{"path":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\babel.config.js","mtime":1705038906658},{"path":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1705038908307},{"path":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\babel-loader\\lib\\index.js","mtime":1705038907812},{"path":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1705038908307},{"path":"E:\\IDEA CODE\\rbacv1\\rbac_front_v1\\node_modules\\vue-loader\\lib\\index.js","mtime":1705038915248}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBlbXBsb3llZUlkOiB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndXNlcklkJyksCiAgICAgIGJhc2U2NEltYWdlOiAiIiwKICAgICAgc2VsZWN0ZWRGaWxlOiBudWxsCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuc2V0dXBDYW1lcmEoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHNldHVwQ2FtZXJhKCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHN0cmVhbSA9IGF3YWl0IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHsKICAgICAgICAgIHZpZGVvOiB0cnVlCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy4kcmVmcy52aWRlby5zcmNPYmplY3QgPSBzdHJlYW07CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgYWNjZXNzaW5nIHRoZSBjYW1lcmE6JywgZXJyb3IpOwogICAgICB9CiAgICB9LAogICAgY2FwdHVyZUltYWdlKCkgewogICAgICBjb25zdCBjYW52YXMgPSB0aGlzLiRyZWZzLmNhbnZhczsKICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICBjb250ZXh0LmRyYXdJbWFnZSh0aGlzLiRyZWZzLnZpZGVvLCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpOwogICAgICBsZXQgYmFzZTY0ID0gY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJyk7CiAgICAgIHRoaXMudXBsb2FkSW1hZ2UoYmFzZTY0KTsKICAgIH0sCiAgICBhc3luYyB1cGxvYWRJbWFnZShiYXNlNjQpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBiYXNlNjREYXRhID0gYmFzZTY0LnJlcGxhY2UoL15kYXRhOmltYWdlXC9bYS16XSs7YmFzZTY0LC8sICcnKTsKICAgICAgICBsZXQgcGF5bG9hZCA9IHsKICAgICAgICAgIGJhc2U2NEltYWdlOiBiYXNlNjREYXRhLAogICAgICAgICAgZW1wbG95ZWVJZDogdGhpcy5lbXBsb3llZUlkCiAgICAgICAgfTsKICAgICAgICBhd2FpdCB0aGlzLiRodHRwLnBvc3QoJy9mYWNlL3VwbG9hZCcsIHBheWxvYWQpOwogICAgICAgIGNvbnNvbGUubG9nKCdJbWFnZSB1cGxvYWRlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICBjb25zb2xlLmxvZyhwYXlsb2FkKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGxvYWRpbmcgdGhlIGltYWdlOicsIGVycm9yKTsKICAgICAgfQogICAgfSwKICAgIG9uRmlsZVNlbGVjdGVkKGV2ZW50KSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRGaWxlID0gZXZlbnQudGFyZ2V0LmZpbGVzWzBdOwogICAgfSwKICAgIHVwbG9hZEZpbGUoKSB7CiAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIHRoaXMuc2VsZWN0ZWRGaWxlKTsKICAgICAgYXhpb3MucG9zdCgnL2ZhY2UvdXBsb2FkRmlsZScsIGZvcm1EYXRhLCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdtdWx0aXBhcnQvZm9ybS1kYXRhJwogICAgICAgIH0KICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ0ZpbGUgdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5Jyk7CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGxvYWRpbmcgdGhlIGZpbGU6JywgZXJyb3IpOwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"mappings":"AAWA;AAEA;EACAA;IACA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;EACA;EACAC;IACA;MACA;QACA;UAAAC;QAAA;QACA;MACA;QACAC;MACA;IACA;IACAC;MACA;MACA;MACAC;MACA;MACA;IACA;IACA;MACA;QACA;QACA;UACAP;UACAD;QACA;QACA;QACAM;QACAA;MACA;QACAA;MACA;IACA;IACAG;MACA;IACA;IACAC;MACA;MACAC;MAEAC;QACAC;UACA;QACA;MACA,GACAC;QACAR;MACA,GACAS;QACAT;MACA;IACA;EACA;AACA","names":["data","employeeId","base64Image","selectedFile","mounted","methods","video","console","captureImage","context","onFileSelected","uploadFile","formData","axios","headers","then","catch"],"sourceRoot":"src/views/recognition","sources":["index.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <video ref=\"video\" width=\"640\" height=\"480\" autoplay></video>\r\n    <button @click=\"captureImage\">拍照并上传</button>\r\n    <input type=\"file\" @change=\"onFileSelected\">\r\n    <button @click=\"uploadFile\">上传图片</button>\r\n    <canvas ref=\"canvas\" width=\"640\" height=\"480\" style=\"display: none;\"></canvas>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      employeeId: window.sessionStorage.getItem('userId'),\r\n      base64Image: \"\",\r\n      selectedFile: null,\r\n    }\r\n  },\r\n  mounted() {\r\n    this.setupCamera();\r\n  },\r\n  methods: {\r\n    async setupCamera() {\r\n      try {\r\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true });\r\n        this.$refs.video.srcObject = stream;\r\n      } catch (error) {\r\n        console.error('Error accessing the camera:', error);\r\n      }\r\n    },\r\n    captureImage() {\r\n      const canvas = this.$refs.canvas;\r\n      const context = canvas.getContext('2d');\r\n      context.drawImage(this.$refs.video, 0, 0, canvas.width, canvas.height);\r\n      let base64 = canvas.toDataURL('image/png');\r\n      this.uploadImage(base64);\r\n    },\r\n    async uploadImage(base64) {\r\n      try {\r\n        const base64Data = base64.replace(/^data:image\\/[a-z]+;base64,/, '');\r\n        let payload = {\r\n          base64Image: base64Data,\r\n          employeeId: this.employeeId\r\n        };\r\n        await this.$http.post('/face/upload', payload);\r\n        console.log('Image uploaded successfully');\r\n        console.log(payload);\r\n      } catch (error) {\r\n        console.error('Error uploading the image:', error);\r\n      }\r\n    },\r\n    onFileSelected(event) {\r\n      this.selectedFile = event.target.files[0];\r\n    },\r\n    uploadFile() {\r\n      const formData = new FormData();\r\n      formData.append('file', this.selectedFile);\r\n\r\n      axios.post('/face/uploadFile', formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data'\r\n        }\r\n      })\r\n          .then(response => {\r\n            console.log('File uploaded successfully');\r\n          })\r\n          .catch(error => {\r\n            console.error('Error uploading the file:', error);\r\n          });\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}]}